# MY_AL_Learning
记录研二第一学期的学习过程

---
## 新想法：
### 1. 数据增强能否对图片局部进行处理
   比如原来是一张图片整体旋转25°/35°...，但是有的增强是无用的，能否只对图片中的有用信息做旋转，然后模仿MixMatch的方法，
   多次增强之后，用分类器预测，再平均+sharpen。
### 2. Mix主动学习
   把不同query方法的得分，平均再sharpen。
### 3. 强化学习+少样本+自监督
### 4. 强化学习+遗传算法
解决收敛速度慢的问题；

---
## 2021/10计划
1. 增强轨迹：实现DAugGI_eta1和DAugGI_eta2。
2. 修改论文第二稿；
    截至时间：2021-10-20；
3. 11月8号分享论文。
4. 11月8号-12号院内评审。

### 周工作安排（10/27-10/29）
1. 修改终审论文（10/28）【OK】；
   稿件计划修回时间：2021-11-14
2. 写开题报告；
3. 提交中期评定表（10/27）【OK】；
4. 申请特别奖学金（10/27）【OK】；
5. 做好党支部换届表决票（10/27）【OK】；

#### 2021/10/28
- 今日工作：
1. 打印中期评定表；
2. 写实践课程考核表+老师签字；
3. 邮寄保密审查材料；
4. 写开题报告（40%）
- 明日安排：
1. 写开题报告；
2. 参加党支部换届。

#### 2021/10/27
- 今日工作：
1. 制作党支部换届表决票；
2. 向编辑部反映最新稿件错误问题;
3. 申请特别奖学金；

- 明日安排：
1. 打印中期评定表；
2. 写实践课程考核表+老师签字；


### 周工作安排（10/18-10/22）

1.跑完整的cat-dauggi对比实验；

2.看论文找信息量和多样性的思路。

2021/10/22

- 今日工作：

  1.测试轨迹长度都是1000？

  是的，没有最终的done设置，只限定了最大轨迹长度。

  2.模型输出noise太大？

  感觉是的，action space：Box(-1,1,(6,),float32)，而noise是从均值为0，方差为模型输出的高斯分布中采样得到。也是在0.7左右的数量级。

  同时加噪后没有做裁减，导致action超过[-1,1]范围。

  3.观察action范围对加噪后action做裁减，比较cat noise的数量级与我的模型输出noise数量级。

  4.可以继续尝试一下original+clip/weight_lambda。

  5.感觉模型输出cov做sigmoid处理是不太合理的，因为大部分都会使得cov=-1/1，只有少部分在（-1，1）间。

- 明日安排：

2021/10/21

- 今日工作：

  1.分析noise network不好的原因可能是模型输出cov太大，导致noise太大，需要对比以下我生成的noise与cat的noise数量级。

  可以修改semi loss的权重为0.01，0.001试试。

- 明日安排：

  1.写开题报告。

2021/10/19

- 今日工作：

  1.stochastic_policy=False.

  2.服务器装tf2.1:

  ```python
  pip install tensorflow-gpu==2.1
  conda install cudnn=7.6 -c https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/linux-64/
  ```

  3.发现semi_path: ../data/HalfCheetah-v2/HalfCheetah-v2_expert_50_avgreturn-2437.5422168857763.npz可能存在问题

  即使semi_path处也处理为只使用7条轨迹，但是self.semilabels没有处理，仍然是50条轨迹，所以补充处理self.semilabels为 traj_limitation=7条。

  4.训练mujoco不需要filter(0,1)过滤不成功的轨迹，因为对于论文中的结果（0.9+success）来说都是很好的轨迹。

  而对于 Manipulation任务需要filter，还需要BC预训练10000步来加速gail的学习。

- 明日安排：

2021/10/18

- 今日工作：

  1.发现跑的实验，actor没有收敛，尝试增加专家轨迹数看看能不能收敛。

- 明日安排：

### 周工作安排（10/11-10/15）

1.实现想法：CAT-eta，RNN编码器；

2.看论文；

3.实验SQIL-eta：
（1）在不同稀疏奖赏环境下的效果；

（2）SQIL文章实验下的效果。

分别实验1/5/10/50条专家轨迹效果。

4.思考在CAT基础上如何做自监督：

（1）在CAT内部添加什么信息；

（2）在自监督框架内，CAT框架外添加什么信息；

（3）考虑是否增加Oracle信息（比如：对生成的轨迹做判断，轨迹是好是坏）

5.准备支部共建

（1）想一个主题；

（2）参会10个人；

（3）找3个人做七一讲话精神的学习总结（分享）；（10月15号）

（4）准备PPT；

（5）最后写一个新闻稿。

2021/10/17

- 今日工作：

  1.准备“七一”讲话精神学习分享PPT+讲稿；

  2.修改baselines代码用于tensorflow-gpu=2.4：

  (1) /home/hehua/下载/baselines/baselines/common/misc_util.py

  ```python
  tf.random.set_seed(myseed)# 2=========================================20211017 20:28
  ```

  (2)/home/hehua/下载/baselines/baselines/common/mpi_running_mean_std.py

  ```python
  import tensorflow.compat.v1 as tf, baselines.common.tf_util as U, numpy as np# 4=====================20211017 20:28
  ```

  (3) /home/hehua/下载/baselines/baselines/common/tf_util.py

  ```python
  import tensorflow.compat.v1 as tf # pylint: ignore-module 6=========================================20211017 20:28
  ```

  (4) /home/hehua/下载/baselines/baselines/common/distributions.py

  ```python
  return self.mean + self.std * tf.random.normal(tf.shape(self.mean))# 8=========================================20211017 20:28
  ```

  ```python
  import tensorflow.compat.v1 as tf# 10=========================================20211017 20:28
  ```

- 明日安排：

  1.跑GAIL；

  2.查看noisenetwork输出的方差是否最后都为0了。

2021/10/15

- 今日工作：

  1.修改214密码SX2016056；

  2.注释214密钥。

  3.整理了cat_dauggi日志变量含义。

  4.改noise network输出为正太分布对角协方差的对角元。（$-\lambda||cov||_2^2$）

- 明日安排：

  1.跑gail

  2.解决gpu问题

  3.做七一讲话学习总结PPT。

2021/10/14

- 今日工作：

  1.改代码为noise network，在209卡1上跑起来了；

  这个也被挤掉了，在本地跑起来了。估计明天也跑不完。

  2.209卡0上的cat训好了似乎。

  ~_~似乎没有训好，可能是被挤掉了。

  3.CAT如何保存的模型；【OK】

  4.如何验证CAT；【OK】

- 明日安排：

  1.训练gail。

  2.改成GPU跑代码

#### 2021/10/13

- 今日工作：

  DAugGI代码跑起来了～～～～

- 明日安排：

  1.修改代码为noise network

#### 2021/10/12

- 今日工作：

  1.修改代码：DAugGI_NoiseNetwork。

  发现了一个巨坑，不停的填坑，最后发现没办法再动代码了，牵一发而动全身。唉～

  2.不同环境专家轨迹要求数量；

  基本都在1-50之间（参考CAT就行）。

- 明日安排：

  1.重写CAT代码

#### 2021/10/11

- 今日工作：

  1.CAT训练：

  （1）太慢：48+14=62h，跑到890个episode，平均14.35episode/h。因此，需要83.63h跑到1200个episode，仍需要21.63h，大概在12日早上6点左右跑完。

  （2）生成轨迹效果提升慢：论文中说明使用的专家轨迹为25条，

  2.查看CAT生成的action序列是否要与环境交互；

  查看原文发现：CAT中加噪后的action需要与环境交互，矫正后的轨迹不需要与环境交互（discriminator的第二项起到了作用：$||a-a'||_2^2$​​）。

- 明日安排：

  1.重置CAT:用25条专家轨迹作GAIL训练。

  2.不同环境专家轨迹要求数量；

  3.修改矫正网络为干扰网络。

  保证增广轨迹的语义信息后，增加信息量和多样性。

### 周工作安排（10/4-10/8）
1. 修改论文第二稿 初稿（10/7）；
2. 实现CAT_eta1和CAT_eta2（10/7-10/9）

#### 2021/10/8

- 今日工作：

  1.实现CAT;

  2.Mujoco稀疏环境：

  (1)**Locally Persistent Exploration in Continuous Control Tasks with Sparse Rewards** 

  当agent走到目标距离λ时，才收到+1的reward：SparseHopper-V2 (λ = 3), SparseHalfCheetah-V2 (λ = 15),Sparse Ant-V2 (λ = 3).

  (2)

  Four Rooms Navigation, Three-link Reacher, Fetch Push and Fetch Pick And Place 

- 明日安排：

  1.实现DAugGI；

#### 2021/10/7

- 今日工作：
1. 修改论文；
- 明日安排：
1. 实现CAT；

#### 2021/10/6
- 今日工作：
1. 看收集的文章。
ALIL;
- 明日安排：
1. 看收集的文章。
2. 尝试改论文；

#### 2021/10/5
- 今日工作：
1. 收集近2018-主动学习文章；
- 明日安排：
1. 看收集的文章。

#### 2021/10/4
- 今日工作：
1. 修改论文 
服务器上跑的代码被挤的跑了3天没跑完~.~乌鱼子
目前14min跑6次，平均2.33min/次，至少还需要605.8min约等于10h，今天晚上能跑完。
2. 写报告（SQIL-eta, MiniGrid-16x16）
- 明日安排：
1. 修改论文；
近三年主动学习的文献调研和分析。
---
## 2021/9计划
1. 增强轨迹;【20%OK】
结合自己想法修改Adversarial Imitation Learning with Trajectorial Augmentation and Correction代码;
2. 修改论文初稿；【OK】
截至时间：2021-10-12；

### 周工作安排（9/27-9/30）
1. 理解GAIL+SQIL，改代码，跑实验。

#### 2021/9/27
- 今日工作：
1. 在服务器215上跑N=3和5的实验（估计晚上9点能跑完）；


### 周工作安排（9/22-9/24）
1. 下载代码；
   Adversarial Imitation Learning with Trajectorial Augmentation and Correction【finish】
2. 结合增广轨迹修改上述代码；
3. 修改论文初稿（9/23）;【finish】

#### 2021/9/26
- 今日工作：
1. 改论文；
2. 跑svhn_resnet18代码+搞服务器环境；
- 明日安排：
1. 搞服务器环境，跑实验；
2. 理解GAIL代码；
3. 查svhn实验模型。

#### 2021/9/24
- 今日工作：
1. 2:30改杨文昕的材料；
2. 做核酸检测（带身份证）；
3. 改GAIL代码(20%)。
- 明日安排：
1. 改论文；
2. 改GAIL代码。
3. 写研究报告；

#### 2021/9/23
- 今日工作：
1. 看论文：PlayVirtual；
2. 下午2：30 专题辅导报告会 学院509会议室。
3. 改论文（20%）。
- 明日安排：
1. 2:30改杨文昕的材料；
2. 做核酸检测（带身份证）；
3. 跑和改SQIL代码；
4. 改论文；

#### 2021/9/22
- 今日工作：
1. 看论文（10%）：PlayVirtual；
2. 下载代码：DAugGI，安装出问题了，python=3.5，安装mj-envs失败。
- 明日安排：
1. 看论文；
2. 下午2：30 专题辅导报告会 学院509会议室。
3. 改论文；